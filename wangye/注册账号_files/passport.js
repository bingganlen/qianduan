"use strict";$(function(){var i={switch:function(){$(".check").each(function(){$(this).on("click",function(){$(this).find("span").toggleClass("already")})})},registInit:function(){if("undefined"!=typeof okcalsses||"undefined"!=typeof errclass){if(okcalsses.length>0)for(var i=0;i<okcalsses.length;i++)this.rightInit($("."+okcalsses[i])),$("."+okcalsses[i]).get(0).isSubmit=!0;""==errclass&&"undefined"==errclass||("userName"==errclass?this.errInit():"iphone"==errclass?this.errInit():"re_email"==errclass?this.errInit():"re_password"==errclass&&this.errInit())}},errInit:function(){$("."+errclass).addClass("red_border").siblings(".error_tips").show().find("span").html(errmsg)},rightInit:function(i){i.removeClass("red_border").siblings(".error_tips").hide().end().next(".right_icon").show()},register:function(){function i(i){!function(){var i=$("#mobile").val();if(S=1,""==i)return s(f,"请输入手机号码"),void(S=0);if(!_.mobile.test(i))s(f,C.mobile.msg),S=0}(),S?function(){$("#J_getCode").hide(),$("#J_second").html("60"),$("#J_resetCode").show(),$("#J_resetCode").attr("disabled","disabled");var i=60,s=null;s=setInterval(function(){(i-=1)>0?$("#J_second").html(i):(clearInterval(s),$("#J_getCode").show(),$("#J_resetCode").hide())},1e3)}():$("#phone").focus()}function s(i,s){i.addClass("error_red"),$(".offi_tips").show().html(s)}function t(i,s){i.addClass("veri_err"),$(".veri_tips").show().html(s)}function e(i,s){$(i).addClass("blue_border").removeClass("red_border").parent().find(".error_tips").show().addClass("blank_tips").find("span").html(s)}function u(i,s){i.addClass("red_border").removeClass("blue_border").parent().find(".error_tips").show().removeClass("blank_tips").find("span").html(s),i.next(".right_icon").hide()}function r(i){i.removeClass("blue_border red_border").next(".right_icon").show().end().parent().find(".error_tips").hide()}function F(i){return/^\s+$/.test(i.value)}function n(i){return/\d{8}/.test(i.value)}function o(i,s){var t=!1;return $(i).find("input").each(function(i,e){var u=$(e);if(!u.hasClass(s)&&"hidden"!=u.attr("type")){if(!e.isSubmit)return t=!1,!1;t=!0}}),t}var a=$(".iphone"),m=$(".userName"),l=$(".re_email"),h=$(".re_password"),d=$(".re_password_again"),c=$("#form1"),f=$("#mobile"),b=$("#validateCode"),g=$(".offi_tips"),v=$("#step1Form"),p=$(".get_code"),x=$(".pc_inpt"),D=$("#PcForm"),_={mobile:/^1[0-9]{10}$/,userName:/^[a-zA-Z0-9_]{6,20}$/,nickName:/^[a-zA-Z]{1,30}$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,password:/^([^\s]){8,20}$/},C={success:{msg:""},empty:{msg:"内容不能为空!"},mobile:{msg:"手机号格式不正确"},hasMobile:{msg:"该手机号已经被注册"},validateCode:{msg:"验证码输入不正确"},userError:{msg:"用户名格式不正确!"},hasUser:{msg:"该用户名已经被注册!"},emailError:{msg:"邮箱格式不正确!"},hasEmail:{msg:"邮箱已经被注册了!"},passwordStrength:{msg:"8-20个字符；只能包含大小写、数字以及标点（空格除外）",1:"低",2:"中",3:"高"},passwordError:{msg:"两次输入不一致，请重新输入."},prompt:{msg:"6～20个字符，支持字母、数字和“_”格式，需字母开头"},pwless:{msg:"密码长度过短，请重新输入."},overPasswordMaxLength:{msg:"密码长度超过20位，请重新输入."}};f.on("blur",function(){var i=this,t=$(this);""==this.value?(s($(this),C.empty.msg),this.isSubmit=!1):_.mobile.test(this.value)?$.getJSON(CFG.API_URL+"account/mobileregister?action=validateMobile&mobile="+this.value,function(e){0==e.err?(t.removeClass("error_red"),g.hide(),i.isSubmit=!0):(s(t,e.msg),i.isSubmit=!1)}):(s($(this),C.mobile.msg),this.isSubmit=!1)}),b.on("blur",function(){var i=$(this);""==this.value?(s($(this),C.empty.msg),this.isSubmit=!1):n(this)?(i.removeClass("error_red"),g.hide(),this.isSubmit=!0):(s($(this),C.validateCode.msg),this.isSubmit=!1)}),p.on("click",function(){i(),$.getJSON(CFG.API_URL+"account/mobileregister?action=sendMobileCode&mobile="+$("#mobile").val(),function(i){0==i.err?$(".offi_tips").hide():$(".offi_tips").show().html(i.msg)})});var S=1;x.on("blur",function(){var i=$(this);""==this.value?(t($(this),C.empty.msg),this.isSubmit=!1):n(this)?(i.removeClass("veri_err"),$(".veri_tips").hide(),this.isSubmit=!0):(t($(this),C.validateCode.msg),this.isSubmit=!1)}),a.on("focus",function(){e(this,"请输入您的手机号！")}),a.on("blur",function(){var i=$(this);""==a.val()?(u(i,C.empty.msg),this.isSubmit=!1):_.mobile.test(a.val())?(r(i),this.isSubmit=!0):(u(i,C.mobile.msg),this.isSubmit=!1)}),m.on("focus",function(){e(this,C.prompt.msg)}),m.on("blur",function(){var i=this,s=$(this);F(this)||""==this.value?(u(s,C.empty.msg),this.isSubmit=!1):!function(i){return/^[a-zA-Z0-9_]{6,20}$/.test(i.value)}(this)?(u(s,C.userError.msg),this.isSubmit=!1):$.getJSON(CFG.API_URL+"account/mobileregister?action=validateUsername&username="+this.value,function(t){0==t.err?(r(s),i.isSubmit=!0):(u(s,t.msg),i.isSubmit=!1)})}),l.on("focus",function(){e(this,"请输入您的邮箱！")}),l.on("blur",function(){var i=this,s=$(this);F(this)||""==this.value?(u(s,C.empty.msg),this.isSubmit=!1):(this.value=function(i){return i.value=i.value.replace(/^\s+|\s+$/g,""),i.value}(this),!function(i){return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(i.value)}(this)?(u(s,C.emailError.msg),this.isSubmit=!1):$.getJSON(CFG.API_URL+"account/mobileregister?action=validateEmail&email="+this.value,function(t){0==t.err?(r(s),i.isSubmit=!0):(u(s,t.msg),i.isSubmit=!1)}))}),h.on("focus",function(){e(this,C.passwordStrength.msg)}),h.on("blur",function(){var i=$.trim(h.val()),s=$(this);""==i?(u(s,C.empty.msg),this.isSubmit=!1):i.length<8?(u(s,C.pwless.msg),this.isSubmit=!1):i.length>20?(u(s,C.overPasswordMaxLength.msg),this.isSubmit=!1):_.password.test(i)&&(r(s),this.isSubmit=!0)}),d.on("focus",function(){e(this,C.passwordStrength.msg)}),d.on("blur",function(){var i=$.trim(d.val()),s=$(this);""==i?(u(s,C.empty.msg),this.isSubmit=!1):i!=$.trim(h.val())?(u(s,C.passwordError.msg),this.isSubmit=!1):(r(s),this.isSubmit=!0)}),$("#pcSec").on("click",function(){var i=!0;""==x.val()?(t(x,C.empty.msg),i=!1):n(x.get(0))?(x.removeClass("veri_err"),$(".veri_tips").hide(),i&&D.submit()):(t(x,C.validateCode.msg),i=!1)}),D.on("submit",function(){var i=o("#PcForm","next_step");if(!i){$(this).find("input").filter("input[type!=submit][type!=hidden]").each(function(i,s){""==s.value&&t($(this),C.empty.msg)})}return i}),$("#next_step").on("click",function(){var i=CFG.API_URL+"account/mobileregister?action=validateMobile&mobile="+$("#mobile").val(),t=!0;$.getJSON(i,{val:f.val()}).done(function(i){parseInt(i.err)>0?(s(f,i.msg),t=!1):(f.removeClass("error_red"),g.hide(),t&&v.submit())})}),v.on("submit",function(){var i=o("#step1Form","next_step");if(!i){$(this).find("input").filter("input[type!=submit][type!=hidden]").each(function(i,t){""==t.value&&s($(this),C.empty.msg)})}return i}),c.on("submit",function(){var i=o("#form1","regist");if(!i){$(this).find("input").filter("input[type!=submit][type!=hidden]").each(function(i,s){""==s.value&&u($(this),C.empty.msg)})}return i})}};i.switch(),i.registInit(),i.register()});